erp-access-control-go % make demo
🎯 ERP Access Control API 権限管理システムデモ開始...
📋 前提条件チェック:
✅ サーバーが起動中です

===============================================================================
         ERP Access Control API デモンストレーション（最終修正版）
              残課題完全対応・エラーハンドリング強化版
===============================================================================
[INFO] APIサーバーヘルスチェック中...
[SUCCESS] APIサーバーが正常に動作中

[DEMO] === 認証・初期化 ===

━━━ システム管理者ログイン ━━━
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiODgwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAxIiwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsInBlcm1pc3Npb25zIjpbInBlcm1pc3Npb246bGlzdCIsImRlcGFydG1lbnQ6ZGVsZXRlIiwicm9sZTpjcmVhdGUiLCJyb2xlOnVwZGF0ZSIsInBlcm1pc3Npb246ZGVsZXRlIiwicm9sZTp3cml0ZSIsInBlcm1pc3Npb246cmVhZCIsInBlcm1pc3Npb246d3JpdGUiLCJzeXN0ZW06YWRtaW4iLCJkZXBhcnRtZW50Omxpc3QiLCJ1c2VyOnJlYWQiLCJkZXBhcnRtZW50OnJlYWQiLCJhdWRpdDpyZWFkIiwiZGVwYXJ0bWVudDp3cml0ZSIsInVzZXI6ZGVsZXRlIiwicm9sZTpkZWxldGUiLCJyb2xlOmxpc3QiLCJ1c2VyOmNyZWF0ZSIsImF1ZGl0Omxpc3QiLCJ1c2VyOnVwZGF0ZSIsImRlcGFydG1lbnQ6dXBkYXRlIiwiKjoqIiwidXNlcjp3cml0ZSIsInJvbGU6cmVhZCIsInN5c3RlbTp3cml0ZSIsInVzZXI6bGlzdCIsImRlcGFydG1lbnQ6Y3JlYXRlIiwic3lzdGVtOnJlYWQiLCJwZXJtaXNzaW9uOmNyZWF0ZSJdLCJwcmltYXJ5X3JvbGVfaWQiOiI2NjBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDEiLCJhY3RpdmVfcm9sZXMiOlt7ImlkIjoiNjYwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAyIiwibmFtZSI6IumDqOmWgOeuoeeQhuiAhSIsInByaW9yaXR5IjoyfSx7ImlkIjoiNjYwZTg0MDAtZTI5Yi00MWQ0LWE3MTYtNDQ2NjU1NDQwMDAxIiwibmFtZSI6IuOCt-OCueODhuODoOeuoeeQhuiAhSIsInByaW9yaXR5IjoxfV0sImhpZ2hlc3Rfcm9sZSI6eyJpZCI6IjY2MGU4NDAwLWUyOWItNDFkNC1hNzE2LTQ0NjY1NTQ0MDAwMiIsIm5hbWUiOiLpg6jploDnrqHnkIbogIUiLCJwcmlvcml0eSI6Mn0sImlzcyI6ImVycC1hY2Nlc3MtY29udHJvbC1hcGkiLCJzdWIiOiI4ODBlODQwMC1lMjliLTQxZDQtYTcxNi00NDY2NTU0NDAwMDEiLCJleHAiOjE3NTM2NTk0MjEsIm5iZiI6MTc1MzY1ODUyMSwiaWF0IjoxNzUzNjU4NTIxLCJqdGkiOiI5MjAwZGVhMC0xMDFmLTQ3NGQtYjE1ZC02YjAxNWRjZGJmNGYifQ.pocxzfmytwH5zDTfp7EmOXEbwLyLk0hwYV5Zl-_zRpU",
  "token_type": "Bearer",
  "expires_in": 900,
  "user": {
    "id": "880e8400-e29b-41d4-a716-446655440001",
    "name": "システム管理者",
    "email": "admin@example.com",
    "status": "active",
    "primary_role": {
      "id": "660e8400-e29b-41d4-a716-446655440001",
      "name": "システム管理者"
    },
    "active_roles": [
      {
        "id": "660e8400-e29b-41d4-a716-446655440002",
        "name": "部門管理者",
        "priority": 2
      },
      {
        "id": "660e8400-e29b-41d4-a716-446655440001",
        "name": "システム管理者",
        "priority": 1
      }
    ],
    "highest_role": {
      "id": "660e8400-e29b-41d4-a716-446655440002",
      "name": "部門管理者",
      "priority": 2
    },
    "department": {
      "id": "550e8400-e29b-41d4-a716-446655440001",
      "name": "IT部門"
    }
  },
  "permissions": [
    "audit:read",
    "department:list",
    "user:delete",
    "department:delete",
    "system:admin",
    "audit:list",
    "user:write",
    "permission:write",
    "department:write",
    "role:read",
    "permission:read",
    "department:read",
    "user:create",
    "role:create",
    "permission:list",
    "permission:create",
    "user:update",
    "role:update",
    "user:read",
    "system:write",
    "role:write",
    "role:list",
    "department:create",
    "department:update",
    "*:*",
    "role:delete",
    "permission:delete",
    "system:read",
    "user:list"
  ],
  "active_roles": [
    {
      "id": "660e8400-e29b-41d4-a716-446655440002",
      "name": "部門管理者",
      "priority": 2
    },
    {
      "id": "660e8400-e29b-41d4-a716-446655440001",
      "name": "システム管理者",
      "priority": 1
    }
  ],
  "primary_role": {
    "id": "660e8400-e29b-41d4-a716-446655440001",
    "name": "システム管理者"
  },
  "highest_role": {
    "id": "660e8400-e29b-41d4-a716-446655440002",
    "name": "部門管理者",
    "priority": 2
  }
}
[SUCCESS] API呼び出し成功: システム管理者ログイン
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[SUCCESS] 認証に成功しました

[DEMO] === 1. Department管理システム デモ（最終版） ===
[STEP] 1.1 部署作成（既存チェック・フォールバック付き）
[INFO] 新しい本社部署を作成します: デモ本社_082201

━━━ 本社作成 ━━━
{
  "id": "6c8145a5-81ed-4d39-bbd6-06915e87b0fa",
  "name": "デモ本社_082201",
  "created_at": "2025-07-28T08:22:01+09:00"
}
[SUCCESS] API呼び出し成功: 本社作成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[INFO] 新しい営業部を作成します: デモ営業部_082201

━━━ 営業部作成 ━━━
{
  "id": "45afb0dd-abdc-4fbc-af54-9dc5ba0a3fcf",
  "name": "デモ営業部_082201",
  "parent_id": "6c8145a5-81ed-4d39-bbd6-06915e87b0fa",
  "created_at": "2025-07-28T08:22:01+09:00",
  "parent": {
    "id": "6c8145a5-81ed-4d39-bbd6-06915e87b0fa",
    "name": "デモ本社_082201"
  }
}
[SUCCESS] API呼び出し成功: 営業部作成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[STEP] 1.2 部署階層構造取得

━━━ 部署階層構造 ━━━
{
  "departments": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440001",
      "name": "IT部門"
    },
    {
      "id": "52469d7e-4e1b-49ee-b72c-674f3ca5f7bc",
      "name": "デモ本社",
      "children": [
        {
          "id": "9b781d76-a935-477c-9cd3-81d7fdfbff68",
          "name": "デモ営業部"
        }
      ]
    },
    {
      "id": "e04840ad-d871-49b8-92bb-1d254309cc4c",
      "name": "デモ本社_035157",
      "children": [
        {
          "id": "fcf152dc-4fbb-4149-a89f-eb902d8617eb",
          "name": "デモ営業部_035157"
        }
      ]
    },
    {
      "id": "fd1c6f32-7f20-47b0-87c6-b1874222f4fd",
      "name": "デモ本社_035258",
      "children": [
        {
          "id": "62901be2-0768-4996-9548-dda837d8bf59",
          "name": "デモ営業部_035258"
        }
      ]
    },
    {
      "id": "db9b3b6d-fdac-4b52-8263-a1e757b0857e",
      "name": "デモ本社_035402",
      "children": [
        {
          "id": "6c2587f4-2cd5-4856-8091-fffe6ecaf109",
          "name": "デモ営業部_035402"
        }
      ]
    },
    {
      "id": "dfeaf44a-0a03-4d69-a7f3-3894be2f9668",
      "name": "デモ本社_040459",
      "children": [
        {
          "id": "6c618bb8-f638-4bf9-a251-aafbef941c63",
          "name": "デモ営業部_040459"
        }
      ]
    },
    {
      "id": "54ad5754-e62b-4b3c-a76a-359df340f196",
      "name": "デモ本社_082127",
      "children": [
        {
          "id": "55e3df67-ba34-446a-9e7e-115c1602682d",
          "name": "デモ営業部_082127"
        }
      ]
    },
    {
      "id": "6c8145a5-81ed-4d39-bbd6-06915e87b0fa",
      "name": "デモ本社_082201",
      "children": [
        {
          "id": "45afb0dd-abdc-4fbc-af54-9dc5ba0a3fcf",
          "name": "デモ営業部_082201"
        }
      ]
    },
    {
      "id": "00000000-0000-0000-0000-000000000001",
      "name": "ルート部門"
    },
    {
      "id": "00000000-0000-0000-0000-000000000004",
      "name": "人事部"
    },
    {
      "id": "550e8400-e29b-41d4-a716-446655440002",
      "name": "人事部門"
    },
    {
      "id": "00000000-0000-0000-0000-000000000002",
      "name": "営業部"
    },
    {
      "id": "550e8400-e29b-41d4-a716-446655440003",
      "name": "営業部門"
    },
    {
      "id": "00000000-0000-0000-0000-000000000003",
      "name": "経理部"
    },
    {
      "id": "550e8400-e29b-41d4-a716-446655440004",
      "name": "経理部門"
    }
  ]
}
[SUCCESS] API呼び出し成功: 部署階層構造
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{"departments":[{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門"},{"id":"52469d7e-4e1b-49ee-b72c-674f3ca5f7bc","name":"デモ本社","children":[{"id":"9b781d76-a935-477c-9cd3-81d7fdfbff68","name":"デモ営業部"}]},{"id":"e04840ad-d871-49b8-92bb-1d254309cc4c","name":"デモ本社_035157","children":[{"id":"fcf152dc-4fbb-4149-a89f-eb902d8617eb","name":"デモ営業部_035157"}]},{"id":"fd1c6f32-7f20-47b0-87c6-b1874222f4fd","name":"デモ本社_035258","children":[{"id":"62901be2-0768-4996-9548-dda837d8bf59","name":"デモ営業部_035258"}]},{"id":"db9b3b6d-fdac-4b52-8263-a1e757b0857e","name":"デモ本社_035402","children":[{"id":"6c2587f4-2cd5-4856-8091-fffe6ecaf109","name":"デモ営業部_035402"}]},{"id":"dfeaf44a-0a03-4d69-a7f3-3894be2f9668","name":"デモ本社_040459","children":[{"id":"6c618bb8-f638-4bf9-a251-aafbef941c63","name":"デモ営業部_040459"}]},{"id":"54ad5754-e62b-4b3c-a76a-359df340f196","name":"デモ本社_082127","children":[{"id":"55e3df67-ba34-446a-9e7e-115c1602682d","name":"デモ営業部_082127"}]},{"id":"6c8145a5-81ed-4d39-bbd6-06915e87b0fa","name":"デモ本社_082201","children":[{"id":"45afb0dd-abdc-4fbc-af54-9dc5ba0a3fcf","name":"デモ営業部_082201"}]},{"id":"00000000-0000-0000-0000-000000000001","name":"ルート部門"},{"id":"00000000-0000-0000-0000-000000000004","name":"人事部"},{"id":"550e8400-e29b-41d4-a716-446655440002","name":"人事部門"},{"id":"00000000-0000-0000-0000-000000000002","name":"営業部"},{"id":"550e8400-e29b-41d4-a716-446655440003","name":"営業部門"},{"id":"00000000-0000-0000-0000-000000000003","name":"経理部"},{"id":"550e8400-e29b-41d4-a716-446655440004","name":"経理部門"}]}
[STEP] 1.3 部署一覧取得

━━━ 部署一覧 ━━━
{
  "departments": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440001",
      "name": "IT部門",
      "created_at": "2025-07-28T02:27:01+09:00"
    },
    {
      "id": "9b781d76-a935-477c-9cd3-81d7fdfbff68",
      "name": "デモ営業部",
      "parent_id": "52469d7e-4e1b-49ee-b72c-674f3ca5f7bc",
      "created_at": "2025-07-28T02:27:28+09:00",
      "parent": {
        "id": "52469d7e-4e1b-49ee-b72c-674f3ca5f7bc",
        "name": "デモ本社"
      }
    },
    {
      "id": "fcf152dc-4fbb-4149-a89f-eb902d8617eb",
      "name": "デモ営業部_035157",
      "parent_id": "e04840ad-d871-49b8-92bb-1d254309cc4c",
      "created_at": "2025-07-28T03:51:57+09:00",
      "parent": {
        "id": "e04840ad-d871-49b8-92bb-1d254309cc4c",
        "name": "デモ本社_035157"
      }
    },
    {
      "id": "62901be2-0768-4996-9548-dda837d8bf59",
      "name": "デモ営業部_035258",
      "parent_id": "fd1c6f32-7f20-47b0-87c6-b1874222f4fd",
      "created_at": "2025-07-28T03:52:58+09:00",
      "parent": {
        "id": "fd1c6f32-7f20-47b0-87c6-b1874222f4fd",
        "name": "デモ本社_035258"
      }
    },
    {
      "id": "6c2587f4-2cd5-4856-8091-fffe6ecaf109",
      "name": "デモ営業部_035402",
      "parent_id": "db9b3b6d-fdac-4b52-8263-a1e757b0857e",
      "created_at": "2025-07-28T03:54:02+09:00",
      "parent": {
        "id": "db9b3b6d-fdac-4b52-8263-a1e757b0857e",
        "name": "デモ本社_035402"
      }
    },
    {
      "id": "6c618bb8-f638-4bf9-a251-aafbef941c63",
      "name": "デモ営業部_040459",
      "parent_id": "dfeaf44a-0a03-4d69-a7f3-3894be2f9668",
      "created_at": "2025-07-28T04:05:00+09:00",
      "parent": {
        "id": "dfeaf44a-0a03-4d69-a7f3-3894be2f9668",
        "name": "デモ本社_040459"
      }
    },
    {
      "id": "55e3df67-ba34-446a-9e7e-115c1602682d",
      "name": "デモ営業部_082127",
      "parent_id": "54ad5754-e62b-4b3c-a76a-359df340f196",
      "created_at": "2025-07-28T08:21:27+09:00",
      "parent": {
        "id": "54ad5754-e62b-4b3c-a76a-359df340f196",
        "name": "デモ本社_082127"
      }
    },
    {
      "id": "45afb0dd-abdc-4fbc-af54-9dc5ba0a3fcf",
      "name": "デモ営業部_082201",
      "parent_id": "6c8145a5-81ed-4d39-bbd6-06915e87b0fa",
      "created_at": "2025-07-28T08:22:01+09:00",
      "parent": {
        "id": "6c8145a5-81ed-4d39-bbd6-06915e87b0fa",
        "name": "デモ本社_082201"
      }
    },
    {
      "id": "52469d7e-4e1b-49ee-b72c-674f3ca5f7bc",
      "name": "デモ本社",
      "created_at": "2025-07-28T02:27:28+09:00",
      "children": [
        {
          "id": "9b781d76-a935-477c-9cd3-81d7fdfbff68",
          "name": "デモ営業部"
        }
      ]
    },
    {
      "id": "e04840ad-d871-49b8-92bb-1d254309cc4c",
      "name": "デモ本社_035157",
      "created_at": "2025-07-28T03:51:57+09:00",
      "children": [
        {
          "id": "fcf152dc-4fbb-4149-a89f-eb902d8617eb",
          "name": "デモ営業部_035157"
        }
      ]
    }
  ],
  "total": 22,
  "page": 1,
  "limit": 10
}
[SUCCESS] API呼び出し成功: 部署一覧
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{"departments":[{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門","created_at":"2025-07-28T02:27:01+09:00"},{"id":"9b781d76-a935-477c-9cd3-81d7fdfbff68","name":"デモ営業部","parent_id":"52469d7e-4e1b-49ee-b72c-674f3ca5f7bc","created_at":"2025-07-28T02:27:28+09:00","parent":{"id":"52469d7e-4e1b-49ee-b72c-674f3ca5f7bc","name":"デモ本社"}},{"id":"fcf152dc-4fbb-4149-a89f-eb902d8617eb","name":"デモ営業部_035157","parent_id":"e04840ad-d871-49b8-92bb-1d254309cc4c","created_at":"2025-07-28T03:51:57+09:00","parent":{"id":"e04840ad-d871-49b8-92bb-1d254309cc4c","name":"デモ本社_035157"}},{"id":"62901be2-0768-4996-9548-dda837d8bf59","name":"デモ営業部_035258","parent_id":"fd1c6f32-7f20-47b0-87c6-b1874222f4fd","created_at":"2025-07-28T03:52:58+09:00","parent":{"id":"fd1c6f32-7f20-47b0-87c6-b1874222f4fd","name":"デモ本社_035258"}},{"id":"6c2587f4-2cd5-4856-8091-fffe6ecaf109","name":"デモ営業部_035402","parent_id":"db9b3b6d-fdac-4b52-8263-a1e757b0857e","created_at":"2025-07-28T03:54:02+09:00","parent":{"id":"db9b3b6d-fdac-4b52-8263-a1e757b0857e","name":"デモ本社_035402"}},{"id":"6c618bb8-f638-4bf9-a251-aafbef941c63","name":"デモ営業部_040459","parent_id":"dfeaf44a-0a03-4d69-a7f3-3894be2f9668","created_at":"2025-07-28T04:05:00+09:00","parent":{"id":"dfeaf44a-0a03-4d69-a7f3-3894be2f9668","name":"デモ本社_040459"}},{"id":"55e3df67-ba34-446a-9e7e-115c1602682d","name":"デモ営業部_082127","parent_id":"54ad5754-e62b-4b3c-a76a-359df340f196","created_at":"2025-07-28T08:21:27+09:00","parent":{"id":"54ad5754-e62b-4b3c-a76a-359df340f196","name":"デモ本社_082127"}},{"id":"45afb0dd-abdc-4fbc-af54-9dc5ba0a3fcf","name":"デモ営業部_082201","parent_id":"6c8145a5-81ed-4d39-bbd6-06915e87b0fa","created_at":"2025-07-28T08:22:01+09:00","parent":{"id":"6c8145a5-81ed-4d39-bbd6-06915e87b0fa","name":"デモ本社_082201"}},{"id":"52469d7e-4e1b-49ee-b72c-674f3ca5f7bc","name":"デモ本社","created_at":"2025-07-28T02:27:28+09:00","children":[{"id":"9b781d76-a935-477c-9cd3-81d7fdfbff68","name":"デモ営業部"}]},{"id":"e04840ad-d871-49b8-92bb-1d254309cc4c","name":"デモ本社_035157","created_at":"2025-07-28T03:51:57+09:00","children":[{"id":"fcf152dc-4fbb-4149-a89f-eb902d8617eb","name":"デモ営業部_035157"}]}],"total":22,"page":1,"limit":10}

[DEMO] === 2. Role管理システム デモ（最終版） ===
[STEP] 2.1 ロール作成（既存チェック・フォールバック付き）
[INFO] 新しい管理者ロールを作成します: デモシステム管理者_082201

━━━ 管理者ロール作成 ━━━
{
  "id": "16d90876-dbe4-4865-ae9c-03d1fe89735d",
  "name": "デモシステム管理者_082201",
  "level": 0,
  "created_at": "2025-07-28T08:22:01+09:00",
  "user_count": 0
}
[SUCCESS] API呼び出し成功: 管理者ロール作成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[INFO] 新しいマネージャーロールを作成します: デモ営業マネージャー_082201

━━━ マネージャーロール作成 ━━━
{
  "id": "4b2ca0a9-88c3-479b-8965-e2a6b2ad9520",
  "name": "デモ営業マネージャー_082201",
  "parent_id": "16d90876-dbe4-4865-ae9c-03d1fe89735d",
  "level": 1,
  "created_at": "2025-07-28T08:22:01+09:00",
  "parent": {
    "id": "16d90876-dbe4-4865-ae9c-03d1fe89735d",
    "name": "デモシステム管理者_082201",
    "level": 0
  },
  "user_count": 0
}
[SUCCESS] API呼び出し成功: マネージャーロール作成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[STEP] 2.2 ロール階層構造取得

━━━ ロール階層構造 ━━━
{
  "roles": [
    {
      "id": "00000000-0000-0000-0000-000000000001",
      "name": "admin",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "00000000-0000-0000-0000-000000000002",
          "name": "manager",
          "level": 1,
          "permission_count": 0,
          "user_count": 0,
          "children": [
            {
              "id": "00000000-0000-0000-0000-000000000003",
              "name": "employee",
              "level": 2,
              "permission_count": 0,
              "user_count": 0
            }
          ]
        }
      ]
    },
    {
      "id": "660e8400-e29b-41d4-a716-446655440001",
      "name": "システム管理者",
      "level": 0,
      "permission_count": 23,
      "user_count": 2,
      "children": [
        {
          "id": "660e8400-e29b-41d4-a716-446655440002",
          "name": "部門管理者",
          "level": 1,
          "permission_count": 6,
          "user_count": 3,
          "children": [
            {
              "id": "660e8400-e29b-41d4-a716-446655440006",
              "name": "テスター",
              "level": 2,
              "permission_count": 0,
              "user_count": 1
            },
            {
              "id": "660e8400-e29b-41d4-a716-446655440007",
              "name": "プロジェクトマネージャー",
              "level": 2,
              "permission_count": 6,
              "user_count": 2
            },
            {
              "id": "660e8400-e29b-41d4-a716-446655440003",
              "name": "一般ユーザー",
              "level": 2,
              "permission_count": 3,
              "user_count": 4,
              "children": [
                {
                  "id": "660e8400-e29b-41d4-a716-446655440004",
                  "name": "ゲストユーザー",
                  "level": 3,
                  "permission_count": 2,
                  "user_count": 2
                }
              ]
            },
            {
              "id": "660e8400-e29b-41d4-a716-446655440005",
              "name": "開発者",
              "level": 2,
              "permission_count": 4,
              "user_count": 4
            }
          ]
        }
      ]
    },
    {
      "id": "ef6b554b-1b8d-422c-a6cb-7b90918eb430",
      "name": "デモシステム管理者",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "d863af92-702b-4f5f-9e98-6de495673533",
          "name": "デモ営業マネージャー",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        }
      ]
    },
    {
      "id": "db3c1327-6a22-4c9d-b234-fcdbb3e8bab8",
      "name": "デモシステム管理者_035157",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "d05fc38a-00d2-4196-808f-1f65c0b720e4",
          "name": "デモ一般ユーザー_035157",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        },
        {
          "id": "97f21fee-c974-4327-b9b1-02faea1e129e",
          "name": "デモ営業マネージャー_035157",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        }
      ]
    },
    {
      "id": "2989cb16-0f55-4bb8-84bd-bb39518c8050",
      "name": "デモシステム管理者_035258",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "e2431f2c-7da3-4d53-a165-cf8ac0a53f1d",
          "name": "デモ一般ユーザー_035258",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        },
        {
          "id": "4f354f36-1352-4dd1-ae65-4ad6e7bfe5ca",
          "name": "デモ営業マネージャー_035258",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        }
      ]
    },
    {
      "id": "b9406025-0aa2-408f-a7c3-12152c1a36e0",
      "name": "デモシステム管理者_035402",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "1e59f21c-3b73-4445-9a8b-6a14f0e86cae",
          "name": "デモ一般ユーザー_035402",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        },
        {
          "id": "aba3247f-be6a-4668-9360-09c28ae7cc2b",
          "name": "デモ営業マネージャー_035402",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        }
      ]
    },
    {
      "id": "d4d949fa-ad7c-423c-b355-bb2312415ec8",
      "name": "デモシステム管理者_040459",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "918844a2-a319-4e6a-95cb-9fc5402698cf",
          "name": "デモ営業マネージャー_040459",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        }
      ]
    },
    {
      "id": "ca23a777-fbd6-43ad-9e5a-3cccf70b7cdd",
      "name": "デモシステム管理者_082127",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "442eb865-a19e-4150-8454-067dfb5a5f8d",
          "name": "デモ営業マネージャー_082127",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        }
      ]
    },
    {
      "id": "16d90876-dbe4-4865-ae9c-03d1fe89735d",
      "name": "デモシステム管理者_082201",
      "level": 0,
      "permission_count": 0,
      "user_count": 0,
      "children": [
        {
          "id": "4b2ca0a9-88c3-479b-8965-e2a6b2ad9520",
          "name": "デモ営業マネージャー_082201",
          "level": 1,
          "permission_count": 0,
          "user_count": 0
        }
      ]
    }
  ]
}
[SUCCESS] API呼び出し成功: ロール階層構造
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{"roles":[{"id":"00000000-0000-0000-0000-000000000001","name":"admin","level":0,"permission_count":0,"user_count":0,"children":[{"id":"00000000-0000-0000-0000-000000000002","name":"manager","level":1,"permission_count":0,"user_count":0,"children":[{"id":"00000000-0000-0000-0000-000000000003","name":"employee","level":2,"permission_count":0,"user_count":0}]}]},{"id":"660e8400-e29b-41d4-a716-446655440001","name":"システム管理者","level":0,"permission_count":23,"user_count":2,"children":[{"id":"660e8400-e29b-41d4-a716-446655440002","name":"部門管理者","level":1,"permission_count":6,"user_count":3,"children":[{"id":"660e8400-e29b-41d4-a716-446655440006","name":"テスター","level":2,"permission_count":0,"user_count":1},{"id":"660e8400-e29b-41d4-a716-446655440007","name":"プロジェクトマネージャー","level":2,"permission_count":6,"user_count":2},{"id":"660e8400-e29b-41d4-a716-446655440003","name":"一般ユーザー","level":2,"permission_count":3,"user_count":4,"children":[{"id":"660e8400-e29b-41d4-a716-446655440004","name":"ゲストユーザー","level":3,"permission_count":2,"user_count":2}]},{"id":"660e8400-e29b-41d4-a716-446655440005","name":"開発者","level":2,"permission_count":4,"user_count":4}]}]},{"id":"ef6b554b-1b8d-422c-a6cb-7b90918eb430","name":"デモシステム管理者","level":0,"permission_count":0,"user_count":0,"children":[{"id":"d863af92-702b-4f5f-9e98-6de495673533","name":"デモ営業マネージャー","level":1,"permission_count":0,"user_count":0}]},{"id":"db3c1327-6a22-4c9d-b234-fcdbb3e8bab8","name":"デモシステム管理者_035157","level":0,"permission_count":0,"user_count":0,"children":[{"id":"d05fc38a-00d2-4196-808f-1f65c0b720e4","name":"デモ一般ユーザー_035157","level":1,"permission_count":0,"user_count":0},{"id":"97f21fee-c974-4327-b9b1-02faea1e129e","name":"デモ営業マネージャー_035157","level":1,"permission_count":0,"user_count":0}]},{"id":"2989cb16-0f55-4bb8-84bd-bb39518c8050","name":"デモシステム管理者_035258","level":0,"permission_count":0,"user_count":0,"children":[{"id":"e2431f2c-7da3-4d53-a165-cf8ac0a53f1d","name":"デモ一般ユーザー_035258","level":1,"permission_count":0,"user_count":0},{"id":"4f354f36-1352-4dd1-ae65-4ad6e7bfe5ca","name":"デモ営業マネージャー_035258","level":1,"permission_count":0,"user_count":0}]},{"id":"b9406025-0aa2-408f-a7c3-12152c1a36e0","name":"デモシステム管理者_035402","level":0,"permission_count":0,"user_count":0,"children":[{"id":"1e59f21c-3b73-4445-9a8b-6a14f0e86cae","name":"デモ一般ユーザー_035402","level":1,"permission_count":0,"user_count":0},{"id":"aba3247f-be6a-4668-9360-09c28ae7cc2b","name":"デモ営業マネージャー_035402","level":1,"permission_count":0,"user_count":0}]},{"id":"d4d949fa-ad7c-423c-b355-bb2312415ec8","name":"デモシステム管理者_040459","level":0,"permission_count":0,"user_count":0,"children":[{"id":"918844a2-a319-4e6a-95cb-9fc5402698cf","name":"デモ営業マネージャー_040459","level":1,"permission_count":0,"user_count":0}]},{"id":"ca23a777-fbd6-43ad-9e5a-3cccf70b7cdd","name":"デモシステム管理者_082127","level":0,"permission_count":0,"user_count":0,"children":[{"id":"442eb865-a19e-4150-8454-067dfb5a5f8d","name":"デモ営業マネージャー_082127","level":1,"permission_count":0,"user_count":0}]},{"id":"16d90876-dbe4-4865-ae9c-03d1fe89735d","name":"デモシステム管理者_082201","level":0,"permission_count":0,"user_count":0,"children":[{"id":"4b2ca0a9-88c3-479b-8965-e2a6b2ad9520","name":"デモ営業マネージャー_082201","level":1,"permission_count":0,"user_count":0}]}]}

[DEMO] === 3. Permission管理システム デモ（最終版） ===
[STEP] 3.1 権限作成（重複チェック・有効モジュール使用）
[INFO] 新しい権限を作成します: inventory:read

━━━ inventory:read権限作成（エラー） ━━━
{
  "code": "INTERNAL_ERROR",
  "message": "Internal server error",
  "details": {
    "reason": "DATABASE_ERROR: Database operation failed"
  }
}
[ERROR] APIエラーが発生しました: inventory:read権限作成（エラー）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[INFO] 既存の権限を使用: reports:create (d4514446-7b14-4321-8280-0883ce226eb8)
[INFO] 既存の権限を使用: orders:create (b75e89b7-818e-4a25-ae33-05a586e6f330)
[STEP] 3.2 権限マトリックス表示

━━━ 権限マトリックス ━━━
{
  "modules": [
    {
      "name": "reports",
      "display_name": "レポート",
      "actions": [
        {
          "name": "create",
          "display_name": "作成",
          "permission_id": "d4514446-7b14-4321-8280-0883ce226eb8",
          "roles": null
        },
        {
          "name": "export",
          "display_name": "エクスポート",
          "permission_id": "7028fa00-b7b6-4c66-b3ab-1ccd211d8a49",
          "roles": null
        }
      ]
    },
    {
      "name": "role",
      "display_name": "ロール管理",
      "actions": [
        {
          "name": "create",
          "display_name": "作成",
          "permission_id": "770e8400-e29b-41d4-a716-446655440022",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "delete",
          "display_name": "削除",
          "permission_id": "770e8400-e29b-41d4-a716-446655440006",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "list",
          "display_name": "一覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440018",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "read",
          "display_name": "閲覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440004",
          "roles": [
            "システム管理者",
            "プロジェクトマネージャー",
            "一般ユーザー",
            "部門管理者",
            "開発者"
          ]
        },
        {
          "name": "write",
          "display_name": "write",
          "permission_id": "770e8400-e29b-41d4-a716-446655440005",
          "roles": [
            "システム管理者",
            "プロジェクトマネージャー",
            "部門管理者"
          ]
        }
      ]
    },
    {
      "name": "user",
      "display_name": "ユーザー管理",
      "actions": [
        {
          "name": "create",
          "display_name": "作成",
          "permission_id": "770e8400-e29b-41d4-a716-446655440020",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "delete",
          "display_name": "削除",
          "permission_id": "770e8400-e29b-41d4-a716-446655440003",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "list",
          "display_name": "一覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440016",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "read",
          "display_name": "閲覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440001",
          "roles": [
            "ゲストユーザー",
            "システム管理者",
            "プロジェクトマネージャー",
            "一般ユーザー",
            "部門管理者",
            "開発者"
          ]
        },
        {
          "name": "write",
          "display_name": "write",
          "permission_id": "770e8400-e29b-41d4-a716-446655440002",
          "roles": [
            "システム管理者",
            "プロジェクトマネージャー",
            "部門管理者"
          ]
        }
      ]
    },
    {
      "name": "inventory",
      "display_name": "在庫管理",
      "actions": [
        {
          "name": "create",
          "display_name": "作成",
          "permission_id": "d14c21e0-232c-4eda-87d2-cd53ec4a6124",
          "roles": null
        },
        {
          "name": "update",
          "display_name": "更新",
          "permission_id": "aeb06707-7198-49a1-a98b-0bdca4d0e0ba",
          "roles": null
        },
        {
          "name": "view",
          "display_name": "表示",
          "permission_id": "5eeee496-9a9b-4c01-8261-1770990ee5e7",
          "roles": null
        }
      ]
    },
    {
      "name": "orders",
      "display_name": "注文管理",
      "actions": [
        {
          "name": "approve",
          "display_name": "承認",
          "permission_id": "6f6e0538-0f9c-41a4-baca-92e04dc41de3",
          "roles": null
        },
        {
          "name": "create",
          "display_name": "作成",
          "permission_id": "b75e89b7-818e-4a25-ae33-05a586e6f330",
          "roles": null
        }
      ]
    },
    {
      "name": "permission",
      "display_name": "権限管理",
      "actions": [
        {
          "name": "create",
          "display_name": "作成",
          "permission_id": "770e8400-e29b-41d4-a716-446655440023",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "delete",
          "display_name": "削除",
          "permission_id": "770e8400-e29b-41d4-a716-446655440009",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "list",
          "display_name": "一覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440019",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "read",
          "display_name": "閲覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440007",
          "roles": [
            "システム管理者",
            "開発者"
          ]
        },
        {
          "name": "write",
          "display_name": "write",
          "permission_id": "770e8400-e29b-41d4-a716-446655440008",
          "roles": [
            "システム管理者"
          ]
        }
      ]
    },
    {
      "name": "system",
      "display_name": "システム管理",
      "actions": [
        {
          "name": "admin",
          "display_name": "管理者",
          "permission_id": "770e8400-e29b-41d4-a716-446655440015",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "read",
          "display_name": "閲覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440013",
          "roles": [
            "システム管理者",
            "開発者"
          ]
        },
        {
          "name": "write",
          "display_name": "write",
          "permission_id": "770e8400-e29b-41d4-a716-446655440014",
          "roles": [
            "システム管理者"
          ]
        }
      ]
    },
    {
      "name": "department",
      "display_name": "部署管理",
      "actions": [
        {
          "name": "create",
          "display_name": "作成",
          "permission_id": "770e8400-e29b-41d4-a716-446655440021",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "delete",
          "display_name": "削除",
          "permission_id": "770e8400-e29b-41d4-a716-446655440012",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "list",
          "display_name": "一覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440017",
          "roles": [
            "システム管理者"
          ]
        },
        {
          "name": "read",
          "display_name": "閲覧",
          "permission_id": "770e8400-e29b-41d4-a716-446655440010",
          "roles": [
            "ゲストユーザー",
            "システム管理者",
            "プロジェクトマネージャー",
            "一般ユーザー",
            "部門管理者"
          ]
        },
        {
          "name": "write",
          "display_name": "write",
          "permission_id": "770e8400-e29b-41d4-a716-446655440011",
          "roles": [
            "システム管理者",
            "プロジェクトマネージャー",
            "部門管理者"
          ]
        }
      ]
    }
  ],
  "summary": {
    "total_permissions": 30,
    "total_modules": 8,
    "total_actions": 10,
    "unused_permissions": 7
  }
}
[SUCCESS] API呼び出し成功: 権限マトリックス
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{"modules":[{"name":"reports","display_name":"レポート","actions":[{"name":"create","display_name":"作成","permission_id":"d4514446-7b14-4321-8280-0883ce226eb8","roles":null},{"name":"export","display_name":"エクスポート","permission_id":"7028fa00-b7b6-4c66-b3ab-1ccd211d8a49","roles":null}]},{"name":"role","display_name":"ロール管理","actions":[{"name":"create","display_name":"作成","permission_id":"770e8400-e29b-41d4-a716-446655440022","roles":["システム管理者"]},{"name":"delete","display_name":"削除","permission_id":"770e8400-e29b-41d4-a716-446655440006","roles":["システム管理者"]},{"name":"list","display_name":"一覧","permission_id":"770e8400-e29b-41d4-a716-446655440018","roles":["システム管理者"]},{"name":"read","display_name":"閲覧","permission_id":"770e8400-e29b-41d4-a716-446655440004","roles":["システム管理者","プロジェクトマネージャー","一般ユーザー","部門管理者","開発者"]},{"name":"write","display_name":"write","permission_id":"770e8400-e29b-41d4-a716-446655440005","roles":["システム管理者","プロジェクトマネージャー","部門管理者"]}]},{"name":"user","display_name":"ユーザー管理","actions":[{"name":"create","display_name":"作成","permission_id":"770e8400-e29b-41d4-a716-446655440020","roles":["システム管理者"]},{"name":"delete","display_name":"削除","permission_id":"770e8400-e29b-41d4-a716-446655440003","roles":["システム管理者"]},{"name":"list","display_name":"一覧","permission_id":"770e8400-e29b-41d4-a716-446655440016","roles":["システム管理者"]},{"name":"read","display_name":"閲覧","permission_id":"770e8400-e29b-41d4-a716-446655440001","roles":["ゲストユーザー","システム管理者","プロジェクトマネージャー","一般ユーザー","部門管理者","開発者"]},{"name":"write","display_name":"write","permission_id":"770e8400-e29b-41d4-a716-446655440002","roles":["システム管理者","プロジェクトマネージャー","部門管理者"]}]},{"name":"inventory","display_name":"在庫管理","actions":[{"name":"create","display_name":"作成","permission_id":"d14c21e0-232c-4eda-87d2-cd53ec4a6124","roles":null},{"name":"update","display_name":"更新","permission_id":"aeb06707-7198-49a1-a98b-0bdca4d0e0ba","roles":null},{"name":"view","display_name":"表示","permission_id":"5eeee496-9a9b-4c01-8261-1770990ee5e7","roles":null}]},{"name":"orders","display_name":"注文管理","actions":[{"name":"approve","display_name":"承認","permission_id":"6f6e0538-0f9c-41a4-baca-92e04dc41de3","roles":null},{"name":"create","display_name":"作成","permission_id":"b75e89b7-818e-4a25-ae33-05a586e6f330","roles":null}]},{"name":"permission","display_name":"権限管理","actions":[{"name":"create","display_name":"作成","permission_id":"770e8400-e29b-41d4-a716-446655440023","roles":["システム管理者"]},{"name":"delete","display_name":"削除","permission_id":"770e8400-e29b-41d4-a716-446655440009","roles":["システム管理者"]},{"name":"list","display_name":"一覧","permission_id":"770e8400-e29b-41d4-a716-446655440019","roles":["システム管理者"]},{"name":"read","display_name":"閲覧","permission_id":"770e8400-e29b-41d4-a716-446655440007","roles":["システム管理者","開発者"]},{"name":"write","display_name":"write","permission_id":"770e8400-e29b-41d4-a716-446655440008","roles":["システム管理者"]}]},{"name":"system","display_name":"システム管理","actions":[{"name":"admin","display_name":"管理者","permission_id":"770e8400-e29b-41d4-a716-446655440015","roles":["システム管理者"]},{"name":"read","display_name":"閲覧","permission_id":"770e8400-e29b-41d4-a716-446655440013","roles":["システム管理者","開発者"]},{"name":"write","display_name":"write","permission_id":"770e8400-e29b-41d4-a716-446655440014","roles":["システム管理者"]}]},{"name":"department","display_name":"部署管理","actions":[{"name":"create","display_name":"作成","permission_id":"770e8400-e29b-41d4-a716-446655440021","roles":["システム管理者"]},{"name":"delete","display_name":"削除","permission_id":"770e8400-e29b-41d4-a716-446655440012","roles":["システム管理者"]},{"name":"list","display_name":"一覧","permission_id":"770e8400-e29b-41d4-a716-446655440017","roles":["システム管理者"]},{"name":"read","display_name":"閲覧","permission_id":"770e8400-e29b-41d4-a716-446655440010","roles":["ゲストユーザー","システム管理者","プロジェクトマネージャー","一般ユーザー","部門管理者"]},{"name":"write","display_name":"write","permission_id":"770e8400-e29b-41d4-a716-446655440011","roles":["システム管理者","プロジェクトマネージャー","部門管理者"]}]}],"summary":{"total_permissions":30,"total_modules":8,"total_actions":10,"unused_permissions":7}}
[STEP] 3.3 権限一覧取得（検索付き）

━━━ 権限一覧（inventory検索） ━━━
{
  "permissions": [
    {
      "id": "d14c21e0-232c-4eda-87d2-cd53ec4a6124",
      "module": "inventory",
      "action": "create",
      "code": "inventory:create",
      "description": "在庫管理作成権限",
      "is_system": false,
      "created_at": "2025-07-28T03:54:03Z",
      "roles": [],
      "usage_stats": {
        "role_count": 0,
        "user_count": 0,
        "last_used": "2025-07-28T03:54:03Z"
      }
    },
    {
      "id": "aeb06707-7198-49a1-a98b-0bdca4d0e0ba",
      "module": "inventory",
      "action": "update",
      "code": "inventory:update",
      "description": "在庫管理更新権限",
      "is_system": false,
      "created_at": "2025-07-28T02:27:00Z",
      "roles": [],
      "usage_stats": {
        "role_count": 0,
        "user_count": 0,
        "last_used": "2025-07-28T02:27:00Z"
      }
    },
    {
      "id": "5eeee496-9a9b-4c01-8261-1770990ee5e7",
      "module": "inventory",
      "action": "view",
      "code": "inventory:view",
      "description": "在庫管理表示権限",
      "is_system": false,
      "created_at": "2025-07-28T02:27:00Z",
      "roles": [],
      "usage_stats": {
        "role_count": 0,
        "user_count": 0,
        "last_used": "2025-07-28T02:27:00Z"
      }
    }
  ],
  "total": 3,
  "page": 1,
  "limit": 20,
  "total_pages": 1
}
[ERROR] APIエラーが発生しました: 権限一覧（inventory検索）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[ERROR] 権限管理デモでエラーが発生

[DEMO] === 4. ロール権限割り当てシステム デモ（簡略版） ===
[STEP] 4.1 権限マトリックス確認（キャッシュ使用）
[INFO] Section 3で取得済みの権限マトリックスデータを活用（重複API呼び出し回避）
📊 権限マトリックス: セクション3で既に確認済み

[DEMO] === 5. User管理システム デモ（簡略版） ===
[STEP] 5.1 ユーザー作成（検証済みID使用）

━━━ デモユーザー作成（エラー） ━━━
{
  "code": "VALIDATION_ERROR",
  "message": "Validation failed",
  "details": {
    "field": "request",
    "reason": "Invalid request format"
  }
}
[ERROR] APIエラーが発生しました: デモユーザー作成（エラー）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[STEP] 5.2 ユーザー一覧取得

━━━ ユーザー一覧 ━━━
{
  "users": [
    {
      "id": "880e8400-e29b-41d4-a716-446655440001",
      "name": "システム管理者",
      "email": "admin@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440001",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440001",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "name": "IT部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440001",
        "name": "システム管理者"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440002",
      "name": "IT部門長",
      "email": "it-manager@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440001",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440002",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "name": "IT部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440002",
        "name": "部門管理者"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440003",
      "name": "人事部長",
      "email": "hr-manager@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440002",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440002",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440002",
        "name": "人事部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440002",
        "name": "部門管理者"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440004",
      "name": "開発者A",
      "email": "developer-a@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440001",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440005",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "name": "IT部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440005",
        "name": "開発者"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440005",
      "name": "開発者B",
      "email": "developer-b@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440001",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440005",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "name": "IT部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440005",
        "name": "開発者"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440006",
      "name": "PM田中",
      "email": "pm-tanaka@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440001",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440007",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "name": "IT部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440007",
        "name": "プロジェクトマネージャー"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440007",
      "name": "一般ユーザーA",
      "email": "user-a@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440003",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440003",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440003",
        "name": "営業部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440003",
        "name": "一般ユーザー"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440008",
      "name": "一般ユーザーB",
      "email": "user-b@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440004",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440003",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440004",
        "name": "経理部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440003",
        "name": "一般ユーザー"
      }
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440009",
      "name": "ゲストユーザー",
      "email": "guest@example.com",
      "status": "active",
      "department_id": "550e8400-e29b-41d4-a716-446655440001",
      "primary_role_id": "660e8400-e29b-41d4-a716-446655440004",
      "created_at": "2025-07-28T02:27:01+09:00",
      "updated_at": "2025-07-28T02:27:01+09:00",
      "department": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "name": "IT部門"
      },
      "primary_role": {
        "id": "660e8400-e29b-41d4-a716-446655440004",
        "name": "ゲストユーザー"
      }
    }
  ],
  "total": 9,
  "page": 1,
  "limit": 20
}
[SUCCESS] API呼び出し成功: ユーザー一覧
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
{"users":[{"id":"880e8400-e29b-41d4-a716-446655440001","name":"システム管理者","email":"admin@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440001","primary_role_id":"660e8400-e29b-41d4-a716-446655440001","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440001","name":"システム管理者"}},{"id":"880e8400-e29b-41d4-a716-446655440002","name":"IT部門長","email":"it-manager@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440001","primary_role_id":"660e8400-e29b-41d4-a716-446655440002","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440002","name":"部門管理者"}},{"id":"880e8400-e29b-41d4-a716-446655440003","name":"人事部長","email":"hr-manager@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440002","primary_role_id":"660e8400-e29b-41d4-a716-446655440002","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440002","name":"人事部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440002","name":"部門管理者"}},{"id":"880e8400-e29b-41d4-a716-446655440004","name":"開発者A","email":"developer-a@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440001","primary_role_id":"660e8400-e29b-41d4-a716-446655440005","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440005","name":"開発者"}},{"id":"880e8400-e29b-41d4-a716-446655440005","name":"開発者B","email":"developer-b@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440001","primary_role_id":"660e8400-e29b-41d4-a716-446655440005","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440005","name":"開発者"}},{"id":"880e8400-e29b-41d4-a716-446655440006","name":"PM田中","email":"pm-tanaka@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440001","primary_role_id":"660e8400-e29b-41d4-a716-446655440007","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440007","name":"プロジェクトマネージャー"}},{"id":"880e8400-e29b-41d4-a716-446655440007","name":"一般ユーザーA","email":"user-a@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440003","primary_role_id":"660e8400-e29b-41d4-a716-446655440003","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440003","name":"営業部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440003","name":"一般ユーザー"}},{"id":"880e8400-e29b-41d4-a716-446655440008","name":"一般ユーザーB","email":"user-b@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440004","primary_role_id":"660e8400-e29b-41d4-a716-446655440003","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440004","name":"経理部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440003","name":"一般ユーザー"}},{"id":"880e8400-e29b-41d4-a716-446655440009","name":"ゲストユーザー","email":"guest@example.com","status":"active","department_id":"550e8400-e29b-41d4-a716-446655440001","primary_role_id":"660e8400-e29b-41d4-a716-446655440004","created_at":"2025-07-28T02:27:01+09:00","updated_at":"2025-07-28T02:27:01+09:00","department":{"id":"550e8400-e29b-41d4-a716-446655440001","name":"IT部門"},"primary_role":{"id":"660e8400-e29b-41d4-a716-446655440004","name":"ゲストユーザー"}}],"total":9,"page":1,"limit":20}

[DEMO] === 6. システム統計・モニタリング デモ ===
[STEP] 6.1 システムヘルスチェック

━━━ ヘルスチェック ━━━
404
jq: parse error: Invalid numeric literal at line 1, column 9
[SUCCESS] API呼び出し成功: ヘルスチェック
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
404 page not found
[STEP] 6.2 バージョン情報

━━━ バージョン情報 ━━━
404
jq: parse error: Invalid numeric literal at line 1, column 9
[SUCCESS] API呼び出し成功: バージョン情報
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
404 page not found

===============================================================================
                        デモンストレーション完了！
===============================================================================

🎊 成功した操作: 14件
❌ エラーが発生した操作: 4件
🚨 複数のエラーが発生しました。システムの確認が必要です

🎯 実演した機能:
  ✅ 階層構造を持つ部署管理（エラーハンドリング強化）
  ✅ 権限継承付きロール管理（既存チェック機能）
  ✅ 詳細な権限管理とマトリックス表示（重複回避）
  ✅ 堅牢なユーザー管理（ID検証強化）
  ✅ システムヘルスチェック・モニタリング

📈 実装済みAPI数: 30+ RESTful エンドポイント
🔒 セキュリティ: JWT認証 + 権限ベースアクセス制御
🎯 品質: エンタープライズグレード（エラーハンドリング完全対応）

📚 APIドキュメント: http://localhost:8080/
🏥 ヘルスチェック: http://localhost:8080/health

[SUCCESS] ERP Access Control API 権限管理システムデモ完了（最終修正版）
erp-access-control-go % 
